## ğŸ¤” ä¸€ä¸ªè®©äººå¤´ç–¼çš„é—®é¢˜
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åˆšå®Œæˆäº† macOS å¹³å°çš„ DeviceInfo æ¨¡å—ï¼Œç°åœ¨è¦æ”¯æŒ iOSã€‚æœ€ç›´æ¥çš„æƒ³æ³•æ˜¯ä»€ä¹ˆï¼Ÿ
å¤åˆ¶ç²˜è´´ï¼Œç„¶åæ”¹æ”¹ API è°ƒç”¨ï¼Ÿ
å¯æ˜¯ç­‰ç­‰...è¿™æ ·ä¸‹å»ï¼Œæ¯å¢åŠ ä¸€ä¸ªå¹³å°å°±è¦ç»´æŠ¤ä¸€å¥—ä»£ç ï¼ŸAndroidã€Windowsã€Linux...æƒ³æƒ³å°±å¤´å¤§ã€‚
## ğŸ’¡ 90% å¤ç”¨ç‡æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ
**å…³é”®æ´å¯Ÿï¼šå¤§éƒ¨åˆ†é€»è¾‘å…¶å®æ˜¯å¹³å°æ— å…³çš„**
ä»”ç»†åˆ†æ DeviceInfo æ¨¡å—ï¼Œä½ ä¼šå‘ç°ä¸€ä¸ªæƒŠäººçš„äº‹å®ï¼š

```cpp
// è¿™äº›é€»è¾‘åœ¨ä»»ä½•å¹³å°éƒ½ä¸€æ ·
std::string DeviceInfoModule::getName() const {
    return "DeviceInfo";
}

std::vector<std::string> DeviceInfoModule::getMethods() const {
    return {
        "getUniqueId",       // methodId = 0
        "getSystemVersion",  // methodId = 1
        "getDeviceId"        // methodId = 2
    };
}

void DeviceInfoModule::invoke(const std::string& methodName,
                             const std::string& args, int callId) {
    try {
        if (methodName == "getUniqueId") {
            std::string uniqueId = getUniqueIdImpl();  // åªæ˜¯è°ƒç”¨ï¼Œä¸å…³å¿ƒå…·ä½“å®ç°
            sendSuccessCallback(callId, uniqueId);
        } else {
            sendErrorCallback(callId, "Unknown method: " + methodName);
        }
    } catch (const std::exception& e) {
        sendErrorCallback(callId, "Method invocation failed: " + std::string(e.what()));
    }
}
```

**Bridge é€šä¿¡åè®®ï¼Ÿå®Œå…¨ä¸€æ ·ï¼**
**æ–¹æ³•æ³¨å†Œæœºåˆ¶ï¼Ÿå®Œå…¨ä¸€æ ·ï¼**
**æ¶ˆæ¯åˆ†å‘é€»è¾‘ï¼Ÿå®Œå…¨ä¸€æ ·ï¼**
**é”™è¯¯å¤„ç†æœºåˆ¶ï¼Ÿå®Œå…¨ä¸€æ ·ï¼**

çœŸæ­£ä¸åŒçš„ï¼Œåªæ˜¯é‚£å‡ ä¸ª `xxxImpl()` æ–¹æ³•çš„åº•å±‚å®ç°ã€‚

## ğŸ—ï¸ å¤´æ–‡ä»¶çš„é­”æ³•

è§£å†³æ–¹æ¡ˆå…¶å®å¾ˆä¼˜é›…ï¼š

```cpp
// common/modules/DeviceInfoModule.h
class DeviceInfoModule : public NativeModule {
public:
    DeviceInfoModule();
    ~DeviceInfoModule() override = default;

    // NativeModule æ¥å£å®ç° - æ‰€æœ‰å¹³å°å…±äº«
    std::string getName() const override;
    std::vector<std::string> getMethods() const override;
    void invoke(const std::string& methodName, const std::string& args,
                int callId) override;

    // å¹³å°ç‰¹å®šçš„å®ç°æ¥å£ - è®©å„å¹³å°å»å¡«è¿™äº›"æ´"
    std::string getUniqueIdImpl() const;
    std::string getSystemVersionImpl() const;
    std::string getDeviceIdImpl() const;

private:
    // å·¥å…·æ–¹æ³•
    std::string createSuccessResponse(const std::string& data) const;
    std::string createErrorResponse(const std::string& error) const;
};
```

**è¿™ä¸ªè®¾è®¡å¤ªèªæ˜äº†ï¼**

æ³¨æ„è¿™é‡Œæ²¡æœ‰ç”¨è™šå‡½æ•°ï¼Œè€Œæ˜¯ç”¨äº†ä¸€ä¸ªæ›´å·§å¦™çš„æ–¹æ³•ï¼š**åŒä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œä¸åŒçš„å®ç°æ–‡ä»¶**ã€‚æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ `.mm` æ–‡ä»¶æ¥å®ç°è¿™äº›æ–¹æ³•ï¼Œç¼–è¯‘æ—¶è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„å®ç°ã€‚

åŸºç±»å®šä¹‰äº†"what"ï¼ˆåšä»€ä¹ˆï¼‰ï¼Œå„å¹³å°å®ç°"how"ï¼ˆæ€ä¹ˆåšï¼‰ã€‚Bridge é€šä¿¡ã€æ–¹æ³•æ³¨å†Œã€æ¶ˆæ¯åˆ†å‘...è¿™äº›å¤æ‚çš„é€»è¾‘åªå†™ä¸€éï¼Œæ‰€æœ‰å¹³å°è‡ªåŠ¨ç»§æ‰¿ã€‚

## ğŸ¯ å¹³å°å®ç°çš„åŠ›é‡

```cpp
// macOS å®ç° - src/macos/modules/deviceinfo/DeviceInfoModule.mm
std::string DeviceInfoModule::getUniqueIdImpl() const {
    @autoreleasepool {
        // å°è¯•è·å–ç¡¬ä»¶ UUID
        io_registry_entry_t ioRegistryRoot =
            IORegistryEntryFromPath(kIOMasterPortDefault, "IOService:/");
        CFStringRef uuidCf = (CFStringRef)IORegistryEntryCreateCFProperty(
            ioRegistryRoot, CFSTR(kIOPlatformUUIDKey), kCFAllocatorDefault, 0);

        if (uuidCf) {
            NSString* uuid = (__bridge NSString*)uuidCf;
            std::string result = [uuid UTF8String];
            CFRelease(uuidCf);
            return result;
        }
        // å¤šå±‚é™çº§æœºåˆ¶...
        return "macOS-" + getDeviceIdImpl() + "-" + getSystemVersionImpl();
    }
}

// iOS å®ç° - src/ios/modules/deviceinfo/DeviceInfoModule.mm
std::string DeviceInfoModule::getUniqueIdImpl() const {
    @autoreleasepool {
        // iOS ç®€åŒ–å®ç°ï¼šä½¿ç”¨ NSUUID ç”Ÿæˆå”¯ä¸€æ ‡è¯†
        // æ³¨æ„ï¼šè¿™ä¸ªå®ç°æ¯æ¬¡å¯åŠ¨éƒ½ä¼šç”Ÿæˆæ–°çš„IDï¼Œé€‚ç”¨äºMVPæµ‹è¯•
        NSUUID* uuid = [NSUUID UUID];
        NSString* uuidString = [uuid UUIDString];
        return [uuidString UTF8String];
    }
}
```

**ç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿäº†**ï¼šä¸¤ä¸ªå¹³å°çš„å®ç°æ–‡ä»¶è‡ªåŠ¨æ‹¥æœ‰äº†å®Œæ•´çš„ Bridge é€šä¿¡èƒ½åŠ›ï¼Œä½†åªéœ€è¦å®ç°å¹³å°å·®å¼‚éƒ¨åˆ†ï¼

## ğŸ¤¯ è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ

æƒ³æƒ³è¿™ä¸ªæ¶æ„çš„å¨åŠ›ï¼š
- **æ–°å¢å¹³å°**ï¼šåªéœ€è¦å®ç°3ä¸ªæ–¹æ³•ï¼Œç«‹åˆ»è·å¾—å®Œæ•´åŠŸèƒ½
- **ä¿®æ”¹é€šä¿¡åè®®**ï¼šæ”¹ä¸€å¤„ï¼Œæ‰€æœ‰å¹³å°è‡ªåŠ¨æ›´æ–°
- **æ·»åŠ æ–°æ–¹æ³•**ï¼šåœ¨åŸºç±»åŠ ä¸€ä¸ªè™šå‡½æ•°ï¼Œæ‰€æœ‰å¹³å°å¼ºåˆ¶å®ç°

ä½†è¿™é‡Œæœ‰ä¸ªæ›´æ·±å±‚çš„é—®é¢˜ï¼š**ä¸ºä»€ä¹ˆæœ‰äº› API èƒ½ 100% å¤ç”¨ï¼Œæœ‰äº›å´å®Œå…¨ä¸èƒ½ï¼Ÿ**

è¿™èƒŒåéšè—ç€è·¨å¹³å°æ¶æ„è®¾è®¡çš„æ ¸å¿ƒç§˜å¯†...